<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .nav {
            display: flex;
            background: #34495e;
            overflow-x: auto;
        }

        .nav-item {
            padding: 15px 25px;
            cursor: pointer;
            transition: background 0.3s;
            white-space: nowrap;
            color: white;
            border: none;
            background: none;
            font-size: 16px;
        }

        .nav-item:hover, .nav-item.active {
            background: #2c3e50;
        }

        .content {
            padding: 30px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e8ed;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .status-low {
            background-color: #ffebee;
            color: #c62828;
        }

        .status-expiring {
            background-color: #fff3e0;
            color: #ef6c00;
        }

        .status-expired {
            background-color: #ffebee;
            color: #d32f2f;
        }

        .status-good {
            background-color: #e8f5e8;
            color: #2e7d32;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .dashboard-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .dashboard-card .number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }

        .filters {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: end;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            padding-left: 40px;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filter-group {
                min-width: auto;
            }
        }

        .export-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .alert-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì¶ Inventory Management System</h1>
            <p>Complete stock tracking and management solution</p>
        </div>

        <div class="nav">
            <button class="nav-item active" onclick="showSection('dashboard')">Dashboard</button>
            <button class="nav-item" onclick="showSection('inventory')">Inventory</button>
            <button class="nav-item" onclick="showSection('add-item')">Add Item</button>
            <button class="nav-item" onclick="showSection('suppliers')">Suppliers</button>
            <button class="nav-item" onclick="showSection('reports')">Reports</button>
            <button class="nav-item" onclick="showSection('settings')">Settings</button>
        </div>

        <div class="content">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <h2>Dashboard Overview</h2>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Total Items</h3>
                        <div class="number" id="totalItems">0</div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Low Stock Items</h3>
                        <div class="number" id="lowStockItems">0</div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Expiring Soon</h3>
                        <div class="number" id="expiringSoon">0</div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Total Value</h3>
                        <div class="number" id="totalValue">MK 0</div>
                    </div>
                </div>

                <div id="alerts-container"></div>

                <h3>Recent Activity</h3>
                <div class="table-container">
                    <table id="recentActivityTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Action</th>
                                <th>Item</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="recentActivityBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Inventory Section -->
            <div id="inventory" class="section">
                <h2>Inventory Management</h2>
                
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" id="searchInput" placeholder="Search items by name, category, or supplier...">
                </div>

                <div class="filters">
                    <div class="filter-group">
                        <label>Category</label>
                        <select id="categoryFilter">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Status</label>
                        <select id="statusFilter">
                            <option value="">All Status</option>
                            <option value="good">Good Stock</option>
                            <option value="low">Low Stock</option>
                            <option value="expiring">Expiring Soon</option>
                            <option value="expired">Expired</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Supplier</label>
                        <select id="supplierFilter">
                            <option value="">All Suppliers</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>&nbsp;</label>
                        <button class="btn" onclick="applyFilters()">Filter</button>
                    </div>
                </div>

                <div class="table-container">
                    <table id="inventoryTable">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Category</th>
                                <th>Current Stock</th>
                                <th>Reorder Level</th>
                                <th>Unit Price (MK)</th>
                                <th>Total Value (MK)</th>
                                <th>Expiry Date</th>
                                <th>Supplier</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Add Item Section -->
            <div id="add-item" class="section">
                <h2>Add New Item</h2>
                <form id="addItemForm">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="form-group">
                            <label>Item Name *</label>
                            <input type="text" id="itemName" required>
                        </div>
                        <div class="form-group">
                            <label>Category *</label>
                            <select id="itemCategory" required>
                                <option value="">Select Category</option>
                                <option value="Electronics">Electronics</option>
                                <option value="Clothing">Clothing</option>
                                <option value="Food & Beverages">Food & Beverages</option>
                                <option value="Health & Beauty">Health & Beauty</option>
                                <option value="Home & Garden">Home & Garden</option>
                                <option value="Stationery">Stationery</option>
                                <option value="Tools & Hardware">Tools & Hardware</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Current Stock *</label>
                            <input type="number" id="currentStock" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>Reorder Level *</label>
                            <input type="number" id="reorderLevel" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>Unit Price (MK) *</label>
                            <input type="number" id="unitPrice" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>Expiry Date</label>
                            <input type="date" id="expiryDate">
                        </div>
                        <div class="form-group">
                            <label>Supplier</label>
                            <select id="itemSupplier">
                                <option value="">Select Supplier</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Location</label>
                            <input type="text" id="itemLocation" placeholder="e.g., Shelf A-1, Room 2">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="itemDescription" rows="3" placeholder="Additional details about the item..."></textarea>
                    </div>
                    <button type="submit" class="btn">Add Item</button>
                </form>
            </div>

            <!-- Suppliers Section -->
            <div id="suppliers" class="section">
                <h2>Supplier Management</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 30px;">
                    <div>
                        <h3>Add New Supplier</h3>
                        <form id="addSupplierForm">
                            <div class="form-group">
                                <label>Supplier Name *</label>
                                <input type="text" id="supplierName" required>
                            </div>
                            <div class="form-group">
                                <label>Contact Person</label>
                                <input type="text" id="contactPerson">
                            </div>
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="tel" id="supplierPhone">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="supplierEmail">
                            </div>
                            <div class="form-group">
                                <label>Address</label>
                                <textarea id="supplierAddress" rows="3"></textarea>
                            </div>
                            <button type="submit" class="btn">Add Supplier</button>
                        </form>
                    </div>
                    
                    <div>
                        <h3>Suppliers List</h3>
                        <div class="table-container">
                            <table id="suppliersTable">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Contact</th>
                                        <th>Phone</th>
                                        <th>Email</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="suppliersBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Section -->
            <div id="reports" class="section">
                <h2>Reports & Analytics</h2>
                
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Items by Category</h3>
                        <div id="categoryChart"></div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Stock Status</h3>
                        <div id="statusChart"></div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Top 5 Most Valuable</h3>
                        <div id="topItems"></div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Low Stock Alert</h3>
                        <div id="lowStockList"></div>
                    </div>
                </div>

                <div class="export-section">
                    <h3>Export Data</h3>
                    <p>Download your inventory data in different formats:</p>
                    <button class="btn" onclick="exportToCSV()">Export to CSV</button>
                    <button class="btn" onclick="exportToJSON()">Export to JSON</button>
                    <button class="btn" onclick="printReport()">Print Report</button>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="section">
                <h2>Settings</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h3>Alert Settings</h3>
                        <div class="form-group">
                            <label>Low Stock Alert (days before reorder level)</label>
                            <input type="number" id="lowStockAlert" value="5" min="1">
                        </div>
                        <div class="form-group">
                            <label>Expiry Alert (days before expiry)</label>
                            <input type="number" id="expiryAlert" value="30" min="1">
                        </div>
                        <button class="btn" onclick="saveSettings()">Save Settings</button>
                    </div>
                    
                    <div>
                        <h3>Data Management</h3>
                        <div class="form-group">
                            <label>Import Data</label>
                            <input type="file" id="importFile" accept=".json,.csv">
                            <button class="btn" onclick="importData()">Import</button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                            <small>‚ö†Ô∏è This will delete all inventory data permanently</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let inventory = JSON.parse(localStorage.getItem('inventory')) || [];
        let suppliers = JSON.parse(localStorage.getItem('suppliers')) || [];
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            lowStockAlert: 5,
            expiryAlert: 30
        };
        let activityLog = JSON.parse(localStorage.getItem('activityLog')) || [];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadSupplierOptions();
            updateDashboard();
            displayInventory();
            displaySuppliers();
            loadSettings();
            
            // Add event listeners
            document.getElementById('addItemForm').addEventListener('submit', addItem);
            document.getElementById('addSupplierForm').addEventListener('submit', addSupplier);
            document.getElementById('searchInput').addEventListener('input', applyFilters);
        });

        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked nav item
            event.target.classList.add('active');
            
            // Update content if needed
            if (sectionId === 'dashboard') {
                updateDashboard();
            } else if (sectionId === 'reports') {
                generateReports();
            }
        }

        // Add new item
        function addItem(e) {
            e.preventDefault();
            
            const item = {
                id: Date.now(),
                name: document.getElementById('itemName').value,
                category: document.getElementById('itemCategory').value,
                currentStock: parseInt(document.getElementById('currentStock').value),
                reorderLevel: parseInt(document.getElementById('reorderLevel').value),
                unitPrice: parseFloat(document.getElementById('unitPrice').value),
                expiryDate: document.getElementById('expiryDate').value,
                supplier: document.getElementById('itemSupplier').value,
                location: document.getElementById('itemLocation').value,
                description: document.getElementById('itemDescription').value,
                dateAdded: new Date().toISOString()
            };
            
            inventory.push(item);
            saveData();
            logActivity('Added', item.name, `Added new item with ${item.currentStock} units`);
            
            // Reset form
            document.getElementById('addItemForm').reset();
            
            // Update displays
            displayInventory();
            updateDashboard();
            
            alert('Item added successfully!');
        }

        // Add new supplier
        function addSupplier(e) {
            e.preventDefault();
            
            const supplier = {
                id: Date.now(),
                name: document.getElementById('supplierName').value,
                contactPerson: document.getElementById('contactPerson').value,
                phone: document.getElementById('supplierPhone').value,
                email: document.getElementById('supplierEmail').value,
                address: document.getElementById('supplierAddress').value,
                dateAdded: new Date().toISOString()
            };
            
            suppliers.push(supplier);
            saveData();
            logActivity('Added Supplier', supplier.name, 'New supplier added to system');
            
            // Reset form
            document.getElementById('addSupplierForm').reset();
            
            // Update displays
            displaySuppliers();
            loadSupplierOptions();
            
            alert('Supplier added successfully!');
        }

        // Display inventory
        function displayInventory(items = inventory) {
            const tbody = document.getElementById('inventoryBody');
            tbody.innerHTML = '';
            
            items.forEach(item => {
                const status = getItemStatus(item);
                const totalValue = item.currentStock * item.unitPrice;
                
                const row = tbody.insertRow();
                row.className = `status-${status.class}`;
                
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.category}</td>
                    <td>${item.currentStock}</td>
                    <td>${item.reorderLevel}</td>
                    <td>MK ${item.unitPrice.toFixed(2)}</td>
                    <td>MK ${totalValue.toFixed(2)}</td>
                    <td>${item.expiryDate ? formatDate(item.expiryDate) : 'N/A'}</td>
                    <td>${item.supplier || 'N/A'}</td>
                    <td>${status.text}</td>
                    <td>
                        <button class="btn" onclick="editItem(${item.id})">Edit</button>
                        <button class="btn btn-danger" onclick="deleteItem(${item.id})">Delete</button>
                    </td>
                `;
            });
        }

        // Display suppliers
        function displaySuppliers() {
            const tbody = document.getElementById('suppliersBody');
            tbody.innerHTML = '';
            
            suppliers.forEach(supplier => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${supplier.name}</td>
                    <td>${supplier.contactPerson || 'N/A'}</td>
                    <td>${supplier.phone || 'N/A'}</td>
                    <td>${supplier.email || 'N/A'}</td>
                    <td>
                        <button class="btn" onclick="editSupplier(${supplier.id})">Edit</button>
                        <button class="btn btn-danger" onclick="deleteSupplier(${supplier.id})">Delete</button>
                    </td>
                `;
            });
        }

        // Update dashboard
        function updateDashboard() {
            const totalItems = inventory.length;
            const lowStockItems = inventory.filter(item => item.currentStock <= item.reorderLevel).length;
            const expiringSoon = inventory.filter(item => {
                if (!item.expiryDate) return false;
                const daysUntilExpiry = getDaysUntilExpiry(item.expiryDate);
                return daysUntilExpiry <= settings.expiryAlert && daysUntilExpiry >= 0;
            }).length;
            const totalValue = inventory.reduce((sum, item) => sum + (item.currentStock * item.unitPrice), 0);
            
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('lowStockItems').textContent = lowStockItems;
            document.getElementById('expiringSoon').textContent = expiringSoon;
            document.getElementById('totalValue').textContent = `MK ${totalValue.toFixed(2)}`;
            
            // Display alerts
            displayAlerts();
            
            // Display recent activity
            displayRecentActivity();
        }

        // Display alerts
        function displayAlerts() {
            const alertsContainer = document.getElementById('alerts-container');
            alertsContainer.innerHTML = '';
            
            const lowStockItems = inventory.filter(item => item.currentStock <= item.reorderLevel);
            const expiringItems = inventory.filter(item => {
                if (!item.expiryDate) return false;
                const daysUntilExpiry = getDaysUntilExpiry(item.expiryDate);
                return daysUntilExpiry <= settings.expiryAlert && daysUntilExpiry >= 0;
            });
            
            if (lowStockItems.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'alert alert-warning';
                alert.innerHTML = `
                    <strong>‚ö†Ô∏è Low Stock Alert:</strong> ${lowStockItems.length} items are at or below reorder level:
                    ${lowStockItems.map(item => item.name).join(', ')}
                `;
                alertsContainer.appendChild(alert);
            }
            
            if (expiringItems.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'alert alert-danger';
                alert.innerHTML = `
                    <strong>üïí Expiry Alert:</strong> ${expiringItems.length} items are expiring soon:
                    ${expiringItems.map(item => `${item.name} (${getDaysUntilExpiry(item.expiryDate)} days)`).join(', ')}
                `;
                alertsContainer.appendChild(alert);
            }
        }

        // Display recent activity
        function displayRecentActivity() {
            const tbody = document.getElementById('recentActivityBody');
            tbody.innerHTML = '';
            
            const recentActivities = activityLog.slice(-10).reverse();
            
            recentActivities.forEach(activity => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${formatDate(activity.date)}</td>
                    <td>${activity.action}</td>
                    <td>${activity.item}</td>
                    <td>${activity.details}</td>
                `;
            });
        }

        // Get item status
        function getItemStatus(item) {
            if (item.expiryDate) {
                const daysUntilExpiry = getDaysUntilExpiry(item.expiryDate);
                if (daysUntilExpiry < 0) {
                    return { class: 'expired', text: 'Expired' };
                } else if (daysUntilExpiry <= settings.expiryAlert) {
                    return { class: 'expiring', text: `Expires in ${daysUntilExpiry} days` };
                }
            }
            
            if (item.currentStock <= item.reorderLevel) {
                return { class: 'low', text: 'Low Stock' };
            }
            
            return { class: 'good', text: 'Good Stock' };
        }

        // Get days until expiry
        function getDaysUntilExpiry(expiryDate) {
            const today = new Date();
            const expiry = new Date(expiryDate);
            const diffTime = expiry - today;
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        // Format date
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString();
        }

        // Load supplier options
        function loadSupplierOptions() {
            const supplierSelects = [
                document.getElementById('itemSupplier'),
                document.getElementById('supplierFilter')
            ];
            
            supplierSelects.forEach(select => {
                if (select) {
                    // Keep the first option (placeholder)
                    const firstOption = select.firstElementChild;
                    select.innerHTML = '';
                    select.appendChild(firstOption);
                    
                    suppliers.forEach(supplier => {
                        const option = document.createElement('option');
                        option.value = supplier.name;
                        option.textContent = supplier.name;
                        select.appendChild(option);
                    });
                }
            });
            
            // Update category filter
            const categoryFilter = document.getElementById('categoryFilter');
            const categories = [...new Set(inventory.map(item => item.category))];
            categoryFilter.innerHTML = '<option value="">All Categories</option>';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        // Apply filters
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const supplierFilter = document.getElementById('supplierFilter').value;
            
            let filteredItems = inventory.filter(item => {
                const matchesSearch = item
